<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>ğŸ‚ é‡‘å¨‡çš„18å²ç”Ÿæ—¥åº†å…¸ ğŸ‚</title>
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      margin: 0;
      overflow: hidden;
      background: #000;
      font-family: 'SimSun', 'å®‹ä½“', serif;
      color: pink;
    }
    
    #app {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
    
    canvas {
      position: absolute;
      top: 0;
      left: 0;
      z-index: 1;
    }
    
    .scene {
      position: absolute;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      opacity: 0;
      transition: opacity 1s ease;
      z-index: 2;
    }
    
    .active {
      opacity: 1 !important;
    }
    
    .cake-container {
      position: relative;
      margin-top: 50px;
      cursor: pointer;
      transform: scale(1);
      transition: transform 0.3s ease;
    }
    
    .cake-container:hover, .cake-container:active {
      transform: scale(1.05);
    }
    
    .cake {
      position: relative;
      width: 320px;
      height: 160px;
      background: linear-gradient(180deg, #fff0f5 0%, #ffe6ee 30%, #ffdce6 70%, #ffccd6 100%);
      border-radius: 20px 20px 30px 30px;
      box-shadow: 0 15px 30px rgba(255, 105, 180, 0.4);
      overflow: hidden;
    }
    
    /* è›‹ç³•çº¹ç† */
    .texture {
      position: absolute;
      width: 100%;
      height: 100%;
      background-image: 
        radial-gradient(circle, rgba(255,255,255,0.3) 1px, transparent 1px),
        linear-gradient(45deg, rgba(255,200,220,0.2) 25%, transparent 25%, transparent 50%, rgba(255,200,220,0.2) 50%, rgba(255,200,220,0.2) 75%, transparent 75%);
      background-size: 20px 20px, 30px 30px;
      opacity: 0.3;
      pointer-events: none;
    }
    
    .cake-layer {
      position: absolute;
      width: 300px;
      height: 20px;
      background: linear-gradient(90deg, #ffb6c1, #ff69b4, #ffb6c1);
      border-radius: 10px;
      bottom: 40px;
      left: 10px;
      box-shadow: inset 0 -2px 5px rgba(0,0,0,0.1);
    }
    
    .frosting {
      position: absolute;
      width: 320px;
      height: 40px;
      background: linear-gradient(180deg, #ffffff, #fff0f5);
      bottom: 120px;
      border-radius: 20px 20px 0 0;
      overflow: hidden;
    }
    
    .frosting::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: repeating-linear-gradient(
        45deg,
        transparent,
        transparent 10px,
        rgba(255,240,245,0.8) 10px,
        rgba(255,240,245,0.8) 20px
      );
    }
    
    .candle-base {
      position: absolute;
      width: 8px;
      height: 30px;
      background: #ff66cc;
      border-radius: 4px;
      bottom: 155px;
      left: 50%;
      transform: translateX(-50%);
      box-shadow: 0 0 15px #ff99cc;
    }
    
    .number-candles {
      position: absolute;
      bottom: 160px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 15px;
    }
    
    .number-candle {
      position: relative;
      font-size: 36px;
      font-weight: bold;
      color: #ff66cc;
      text-shadow: 0 0 10px #ff99cc, 0 0 20px #ff69b4;
      animation: flickerNumber 0.8s infinite alternate;
    }
    
    @keyframes flickerNumber {
      0% { text-shadow: 0 0 10px #ff99cc, 0 0 20px #ff69b4; }
      100% { text-shadow: 0 0 15px #ff99cc, 0 0 30px #ff69b4, 0 0 40px #ff85c0; }
    }
    
    .message {
      font-size: 26px;
      font-weight: bold;
      text-shadow: 0 0 15px rgba(255, 105, 180, 0.8);
      margin: 20px 0;
      animation: glow 2s infinite alternate;
      white-space: nowrap;
    }
    
    @keyframes glow {
      from { text-shadow: 0 0 5px #ff69b4, 0 0 10px #ff69b4; }
      to { text-shadow: 0 0 10px #ff69b4, 0 0 20px #ff69b4, 0 0 30px #ff85c0; }
    }
    
    .wish-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 100;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.5s ease;
    }
    
    .wish-modal.active {
      opacity: 1;
      pointer-events: all;
    }
    
    .wish-content {
      background: linear-gradient(135deg, #ffeff7, #ffe6ee);
      padding: 40px;
      border-radius: 20px;
      text-align: center;
      max-width: 85%;
      box-shadow: 0 15px 40px rgba(255, 105, 180, 0.3);
      border: 2px solid #ff69b4;
    }
    
    .wish-title {
      color: #ff69b4;
      font-size: 28px;
      margin-bottom: 25px;
      font-family: 'SimSun', 'å®‹ä½“', serif;
      text-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .wish-text {
      font-size: 18px;
      color: #d46ea8;
      margin-bottom: 20px;
      line-height: 1.6;
      font-style: italic;
    }
    
    .wish-btn {
      background: linear-gradient(45deg, #ff69b4, #ff1493);
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 30px;
      font-size: 18px;
      cursor: pointer;
      margin-top: 20px;
      font-family: 'SimSun', 'å®‹ä½“', serif;
      box-shadow: 0 8px 20px rgba(255, 105, 180, 0.5);
      transition: all 0.3s ease;
    }
    
    .wish-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 25px rgba(255, 105, 180, 0.6);
    }
    
    .music-control {
      position: fixed;
      bottom: 25px;
      right: 25px;
      width: 60px;
      height: 60px;
      background: rgba(255, 105, 180, 0.9);
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10;
      cursor: pointer;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
      transition: all 0.3s ease;
    }
    
    .music-control:hover {
      transform: scale(1.1);
    }
    
    .music-icon {
      color: white;
      font-size: 28px;
      transition: transform 0.3s ease;
    }
    
    .music-icon.playing {
      animation: rotate 2s linear infinite;
    }
    
    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    
    .countdown {
      position: fixed;
      top: 20px;
      left: 0;
      width: 100%;
      text-align: center;
      font-size: 16px;
      opacity: 0.8;
      z-index: 10;
      color: #ff69b4;
    }
    
    .share-tip {
      position: fixed;
      bottom: 85px;
      left: 0;
      width: 100%;
      text-align: center;
      font-size: 14px;
      opacity: 0.7;
      z-index: 10;
      color: #ff69b4;
    }
  </style>
</head>
<body>
  <div id="app">
    <!-- ç²’å­ç”»å¸ƒ -->
    <canvas ref="canvas"></canvas>
    
    <!-- å€’è®¡æ—¶æ˜¾ç¤º -->
    <div class="countdown" v-if="currentScene === 'fireworks'">
      çƒŸèŠ±ç§€è¿›è¡Œä¸­... {{ Math.ceil((5000 - fireworksTime) / 1000) }}ç§’
    </div>
    
    <!-- åœºæ™¯å®¹å™¨ -->
    <div class="scene" :class="{ active: currentScene === 'cake' }">
      <div class="message">ç¥é‡‘å¨‡ç”Ÿæ—¥å¿«ä¹</div>
      <div class="cake-container" @click="showWishModal">
        <div class="frosting"></div>
        <div class="cake">
          <div class="texture"></div>
          <div class="cake-layer"></div>
        </div>
        <div class="number-candles">
          <div class="number-candle">1</div>
          <div class="number-candle">8</div>
        </div>
      </div>
    </div>
    
    <!-- è®¸æ„¿å¼¹çª— -->
    <div class="wish-modal" :class="{ active: wishVisible }">
      <div class="wish-content">
        <div class="wish-title">âœ¨ äº²çˆ±çš„é‡‘å¨‡ âœ¨</div>
        <div class="wish-text">ç°åœ¨è¯·é—­ä¸Šçœ¼ç›<br>åœ¨å¿ƒé‡Œé»˜é»˜è®¸ä¸‹ä½ çš„18å²å¿ƒæ„¿<br>ç„¶åç‚¹å‡»æŒ‰é’®å¹ç­èœ¡çƒ›å§~</div>
        <button class="wish-btn" @click="blowOutCandles">å¹ç­èœ¡çƒ›</button>
      </div>
    </div>
    
    <!-- éŸ³ä¹æ§åˆ¶æŒ‰é’® -->
    <div class="music-control" @click="toggleMusic">
      <div class="music-icon" :class="{ playing: musicPlaying }">ğŸµ</div>
    </div>
    
    <div class="share-tip">ğŸ“± åˆ†äº«ç»™é‡‘å¨‡ï¼Œå¼€å¯å¥¹çš„ä¸“å±ç”Ÿæ—¥ä»ªå¼</div>
  </div>

  <script>
    new Vue({
      el: '#app',
      data() {
        return {
          currentScene: 'fireworks',
          fireworksTime: 0,
          canvas: null,
          ctx: null,
          particles: [],
          width: window.innerWidth,
          height: window.innerHeight,
          wishVisible: false,
          musicPlaying: false,
          audio: null,
          confettiParticles: []
        }
      },
      
      mounted() {
        this.initCanvas()
        this.startFireworksShow()
        this.animate()
        
        // åˆå§‹åŒ–éŸ³é¢‘
        this.audio = new Audio('https://cdn.jsdelivr.net/gh/kenangundam/sounds@master/happy-birthday-piano.mp3')
        this.audio.loop = true
        this.audio.volume = 0.5
        
        // ç›‘å¬ç”¨æˆ·äº¤äº’æ¥æ’­æ”¾éŸ³ä¹
        document.addEventListener('touchstart', this.initAudio, { once: true })
        document.addEventListener('click', this.initAudio, { once: true })
        
        // 60ç§’ååˆ‡æ¢åˆ°è›‹ç³•åœºæ™¯
        setTimeout(() => {
          this.currentScene = 'cake'
          this.particles = []
        }, 60000)
        
        // ç›‘å¬çª—å£å¤§å°å˜åŒ–
        window.addEventListener('resize', this.handleResize)
      },
      
      methods: {
        initAudio() {
          if (this.audio && !this.musicPlaying) {
            this.audio.play().catch(e => console.log('éŸ³é¢‘æ’­æ”¾éœ€è¦ç”¨æˆ·äº¤äº’'))
          }
        },
        
        toggleMusic() {
          if (!this.audio) return
          
          if (this.musicPlaying) {
            this.audio.pause()
          } else {
            this.audio.play().catch(e => {
              alert('è¯·ç‚¹å‡»é¡µé¢ä»»æ„ä½ç½®åå†æ’­æ”¾éŸ³ä¹å“¦~')
            })
          }
          this.musicPlaying = !this.musicPlaying
        },
        
        showWishModal() {
          this.wishVisible = true
        },
        
        blowOutCandles() {
          // å¹èœ¡çƒ›ç‰¹æ•ˆ
          const candleElements = this.$el.querySelectorAll('.number-candle')
          candleElements.forEach(el => {
            el.style.opacity = '0.3'
            el.style.textShadow = 'none'
          })
          
          // å½©å¸¦çˆ†ç‚¸æ•ˆæœ
          this.createConfettiExplosion()
          
          // 3ç§’åæ¢å¤
          setTimeout(() => {
            candleElements.forEach(el => {
              el.style.opacity = '1'
              el.style.textShadow = '0 0 10px #ff99cc, 0 0 20px #ff69b4'
            })
            this.wishVisible = false
          }, 3000)
        },
        
        createConfettiExplosion() {
          const colors = ['#ff00ff', '#ff69b4', '#ffff00', '#00ffff', '#ff9900', '#da70d6']
          
          for (let i = 0; i < 100; i++) {
            const angle = Math.random() * Math.PI * 2
            const speed = 2 + Math.random() * 5
            const x = this.width / 2 + (Math.cos(angle) * speed * 20)
            const y = this.height / 2 - 100
            
            this.confettiParticles.push({
              x: x,
              y: y,
              vx: Math.cos(angle) * speed,
              vy: Math.sin(angle) * speed - 2,
              color: colors[Math.floor(Math.random() * colors.length)],
              size: 4 + Math.random() * 6,
              life: 60 + Math.random() * 40,
              type: Math.floor(Math.random() * 3) // 0: square, 1: circle, 2: star
            })
          }
          
          this.animateConfetti()
        },
        
        animateConfetti() {
          this.ctx.save()
          for (let i = this.confettiParticles.length - 1; i >= 0; i--) {
            const p = this.confettiParticles[i]
            
            p.y += p.vy
            p.x += p.vx
            p.vy += 0.1
            p.life--
            
            if (p.life > 0) {
              this.ctx.fillStyle = p.color
              if (p.type === 0) {
                this.ctx.fillRect(p.x, p.y, p.size, p.size)
              } else if (p.type === 1) {
                this.ctx.beginPath()
                this.ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2)
                this.ctx.fill()
              } else {
                this.drawStar(p.x, p.y, 5, p.size/2, p.size)
              }
            } else {
              this.confettiParticles.splice(i, 1)
            }
          }
          this.ctx.restore()
          
          if (this.confettiParticles.length > 0) {
            requestAnimationFrame(() => this.animateConfetti())
          }
        },
        
        drawStar(cx, cy, spikes, outerRadius, innerRadius) {
          let rot = Math.PI / 2 * 3
          let x = cx
          let y = cy
          let step = Math.PI / spikes
          
          this.ctx.beginPath()
          this.ctx.moveTo(cx, cy - outerRadius)
          
          for (let i = 0; i < spikes; i++) {
            x = cx + Math.cos(rot) * outerRadius
            y = cy + Math.sin(rot) * outerRadius
            this.ctx.lineTo(x, y)
            rot += step
            
            x = cx + Math.cos(rot) * innerRadius
            y = cy + Math.sin(rot) * innerRadius
            this.ctx.lineTo(x, y)
            rot += step
          }
          
          this.ctx.lineTo(cx, cy - outerRadius)
          this.ctx.closePath()
          this.ctx.fill()
        },
        
        initCanvas() {
          this.canvas = this.$refs.canvas
          this.ctx = this.canvas.getContext('2d')
          this.resizeCanvas()
        },
        
        resizeCanvas() {
          this.width = window.innerWidth
          this.height = window.innerHeight
          this.canvas.width = this.width
          this.canvas.height = this.height
        },
        
        handleResize() {
          this.resizeCanvas()
          this.particles = []
          this.startFireworksShow()
        },
        
        startFireworksShow() {
          // æ¯5ç§’æ”¾ä¸€æ¬¡çƒŸèŠ±ï¼ŒæŒç»­60ç§’
          const intervals = []
          for (let i = 0; i < 12; i++) {
            intervals.push(setTimeout(() => {
              this.launchRandomFirework()
            }, i * 5000))
          }
          
          // æ¸…ç†å®šæ—¶å™¨
          setTimeout(() => {
            intervals.forEach(clearTimeout)
          }, 60000)
        },
        
        launchRandomFirework() {
          const x = 100 + Math.random() * (this.width - 200)
          const y = 100 + Math.random() * (this.height * 0.5)
          const color = this.getRandomColor()
          this.launchFirework(x, y, color)
        },
        
        launchFirework(x, y, color) {
          // ä¸»çˆ†ç‚¸
          const particleCount = 60 + Math.floor(Math.random() * 40)
          for (let i = 0; i < particleCount; i++) {
            const angle = Math.random() * Math.PI * 2
            const speed = 2 + Math.random() * 4
            const life = 40 + Math.random() * 30
            
            this.particles.push({
              x: x,
              y: y,
              vx: Math.cos(angle) * speed,
              vy: Math.sin(angle) * speed,
              radius: 1 + Math.random() * 2.5,
              color: color,
              life: life,
              decay: 0.95 + Math.random() * 0.03,
              alpha: 1
            })
          }
          
          // å°¾è¿¹
          this.particles.push({
            x: x,
            y: y + 30,
            vx: 0,
            vy: -3 - Math.random() * 3,
            radius: 2.5,
            color: '#fff',
            life: 15,
            decay: 0.9,
            alpha: 0.8,
            isTrail: true
          })
        },
        
        getRandomColor() {
          const colors = [
            '#ff00ff', '#ff69b4', '#ff1493', '#da70d6', '#ba55d3', 
            '#ff00ff', '#9932cc', '#8a2be2', '#9400d3', '#800080'
          ]
          return colors[Math.floor(Math.random() * colors.length)]
        },
        
        animate() {
          this.ctx.clearRect(0, 0, this.width, this.height)
          
          for (let i = this.particles.length - 1; i >= 0; i--) {
            const p = this.particles[i]
            
            p.x += p.vx
            p.y += p.vy
            p.vy += 0.05
            p.life--
            p.alpha *= p.decay
            
            if (p.isTrail) {
              p.vy -= 0.15
            }
            
            if (p.life <= 0 || p.alpha <= 0.1) {
              this.particles.splice(i, 1)
              continue
            }
            
            this.ctx.beginPath()
            this.ctx.arc(p.x, p.y, p.radius, 0, Math.PI * 2)
            this.ctx.fillStyle = p.isTrail ? 
              `rgba(255, 255, 255, ${p.alpha})` : 
              `rgba(${parseInt(p.color.slice(1,3), 16)}, ${parseInt(p.color.slice(3,5), 16)}, ${parseInt(p.color.slice(5,7), 16)}, ${p.alpha})`
            this.ctx.fill()
          }
          
          requestAnimationFrame(this.animate)
        }
      },
      
      beforeDestroy() {
        if (this.audio) {
          this.audio.pause()
        }
        window.removeEventListener('resize', this.handleResize)
      }
    })
  </script>
</body>
</html>
